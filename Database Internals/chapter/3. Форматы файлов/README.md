Для эффективного хранения данных на дисках необходимо скомпоновать данные

Строительными блоками являются примитивы (по аналогии с ЯП, например java/kotlin)

Для эффективного сохранения записей переменного размера, таких как строки, боль-
шие двоичные объекты и т. д., можно использовать такой способ организации, как
слоттированная страница (Например в Postgres)

Т.е указатели хранятся отдельно от ячеек с данными. Это позволяет сохранять организацию путем реорганизации указателей,
а удаление осуществлять через обнуления указателя

![slotted-page.png](../../resources/slotted-page.png)
![insert-in-slotted-page.png](../../resources/insert-in-slotted-page.png)

При удалении данных осуществляется удаление указателя и пометка ячейки как свободной.
После чего область попадает в т.н. **_список доступности_**.
Далее имеется две стратегии по дефрагментации ячеек:

1) Первый подходящий, быстро находится, но остается много маленьких кусков
2) Наиболее подходящий, накладные затраты на поиск

В случае если не находится подходящий кусок, то вычисляется объем всех доступных сегментов, если суммы их размера хватает,
то производится **_дефрагментация_** - ячейки запоминаются и перезаписываются последовательно друг за другом
Если же объема не хватает для записи, то необходимо создать страницу переполнения

>Итого имеем схему:
Примитивы -> Ячейки -> Страницы -> Деревья

Чтобы упростить структуру B-дерева, мы предполагаем, что каждый узел занимает одну страницу. Страница состоит из заголовка фиксированного
размера, блока указателей на ячейки и ячеек. Ячейки содержат ключи и указатели
на страницы, представляющие дочерние узлы или соответствующие записи данных.
В B-деревьях используется простая иерархия указателей: идентификаторы страниц
для поиска дочерних узлов в файле дерева и смещения ячеек для поиска ячеек вну-
три страницы

Для обеспечения обратной совместимости между версиям СУБД версия формата файлов должна быть зафиксирована:
В apache cassendra она маркируется в названии файла (na-databasefile.db/ma-databasefile.db) в постгре отдельный файл PG_VERSION

Для выявления ошибок в записи при аппаратных или иных сбоях используются CRC проверки, при этом контрольные суммы вычисляются 
не для целых файлов, а для отдельных страниц, тк маловероятно что файл будет читаться полностью
